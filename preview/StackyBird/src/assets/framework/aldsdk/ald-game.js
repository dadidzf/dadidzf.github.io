!function(){function e(e){var t={};return"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(e){t["[object "+e+"]"]=e.toLowerCase()}),null==e?e:"object"==typeof e||"function"==typeof e?t[function(e){return Object.prototype.toString.call(e)}.call(e)]||"object":typeof e}function t(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()+e()+e()+e()+e()}function n(e,t){p++,e.as=_,e.at=w,e.rq_c=p,e.ifo=u,e.ak=c.app_key,e.uu=d,e.v=o,e.st=Date.now(),e.ev=t,e.wsr=m,""!==a(e.ufo)&&(e.ufo=e.ufo),e.ec=g,wx.Queue.push(function(){return new Promise(function(t){wx.request({url:"https://"+i+".aldwx.com/d.html",data:e,header:{se:f||"",op:h||"",img:x||""},method:"GET",fail:function(){t("")},success:function(e){t(200==e.statusCode?"":"status error")}})})})}function a(e){if(void 0===e||""===e)return"";var t={};for(var n in e)"rawData"!=n&&"errMsg"!=n&&(t[n]=e[n]);return t}function r(e){var t={};for(var n in e)t[n]=e[n];return t}function s(e){for(var t="",n=0;n<e.length;n++)e[n].length>t.length&&(t=e[n]);return t}var o="2.0.0",i="glog",c=require("./ald-game-conf");""===c.app_key&&console.error("\u8bf7\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u586b\u5199\u60a8\u7684app_key"),c.app_key=c.app_key.replace(/\s/g,""),wx.request({url:"https://"+i+".aldwx.com/config/app.json",method:"GET",success:function(e){200===e.statusCode&&(e.data.version!=o&&console.warn("\u60a8\u7684SDK\u4e0d\u662f\u6700\u65b0\u7248\u672c\uff0c\u8bf7\u5c3d\u5feb\u5347\u7ea7\uff01"),e.data.warn&&console.warn(e.data.warn),e.data.error&&console.error(e.data.error))}});var u="",d=function(){var e="";try{e=wx.getStorageSync("aldstat_uuid"),wx.setStorageSync("ald_ifo",!0)}catch(n){e="uuid_getstoragesync"}if(e)u=!1;else{e=t(),u=!0;try{wx.setStorageSync("aldstat_uuid",e)}catch(e){wx.setStorageSync("aldstat_uuid","uuid_getstoragesync")}}return e}(),l={},f="",h="",g=0,p="",m=wx.getLaunchOptionsSync(),v=Date.now(),w=""+Date.now()+Math.floor(1e7*Math.random()),_=""+Date.now()+Math.floor(1e7*Math.random()),y=0,S="",x="",q=!0,I=!1,b=["aldSendEvent","aldOnShareAppMessage","aldShareAppMessage","aldSendSession","aldSendOpenid","aldLevelEvent"],M=["payStart","paySuccess","payFail","die","revive","tools","award"],k=["complete","fail"];void 0===wx.Queue&&(wx.Queue=new function(){this.concurrency=4,this.queue=[],this.tasks=[],this.activeCount=0;var e=this;this.push=function(t){this.tasks.push(new Promise(function(n){var a=function(){e.activeCount++,t().then(function(e){n(e)}).then(function(){e.next()})};e.activeCount<e.concurrency?a():e.queue.push(a)}))},this.all=function(){return Promise.all(this.tasks)},this.next=function(){e.activeCount--,e.queue.length>0&&e.queue.shift()()}},wx.Queue.all()),Promise.all([new Promise(function(e){wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(t){x=s(t.userInfo.avatarUrl.split("/")),e(t)},fail:function(){e("")}}):e("")},fail:function(){e("")}})}),new Promise(function(e){wx.getNetworkType({success:function(t){e(t)},fail:function(){e("")}})}),new Promise(function(e){c.getLocation?wx.getLocation({success:function(t){e(t)},fail:function(){e("")}}):wx.getSetting({success:function(t){t.authSetting["scope.userLocation"]?(wx.getLocation({success:function(t){e(t)},fail:function(){e("")}}),e("")):e("")},fail:function(){e("")}})})]).then(function(e){""!==e[2]?(l.lat=e[2].latitude||"",l.lng=e[2].longitude||"",l.spd=e[2].speed||""):(l.lat="",l.lng="",l.spd=""),""!==e[1]?l.nt=e[1].networkType||"":l.nt="";var t=r(l);""!==e[0]&&(t.ufo=e[0],S=e[0]),n(t,"init")}),wx.onShow(function(e){if(m=e,y=Date.now(),!q&&!I){w=""+Date.now()+Math.floor(1e7*Math.random()),u=!1;try{wx.setStorageSync("ald_ifo",!1)}catch(e){}}q=!1,I=!1;var t=r(l),a=r(l);t.sm=y-v,e.query.ald_share_src&&e.shareTicket&&"1044"===e.scene?(a.tp="ald_share_click",new Promise(function(e){"1044"==m.scene?wx.getShareInfo({shareTicket:m.shareTicket,success:function(t){e(t)},fail:function(){e("")}}):e("")}).then(function(e){a.ct=e,n(a,"event")})):e.query.ald_share_src&&(a.tp="ald_share_click",a.ct="1",n(a,"event")),n(t,"show")}),wx.onHide(function(){var e=r(l);e.dr=Date.now()-y,""===S?wx.getSetting({success:function(t){t.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(t){e.ufo=t,S=t,x=s(t.userInfo.avatarUrl.split("/")),n(e,"hide")}}):n(e,"hide")}}):n(e,"hide")}),wx.onError(function(e){var t=r(l);t.tp="ald_error_message",t.ct=e,g++,n(t,"event")});var O={aldSendEvent:function(e,t){var a=r(l);""!==e&&"string"==typeof e&&e.length<=255?(a.tp=e,"string"==typeof t&&t.length<=255?(a.ct=String(t),n(a,"event")):"object"==typeof t?(JSON.stringify(t).length>=255&&console.error("\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u53c2\u6570\u4e0d\u80fd\u8d85\u8fc7255\u4e2a\u5b57\u7b26"),a.ct=JSON.stringify(t),n(a,"event")):void 0===t||""===t?n(a,"event"):console.error("\u4e8b\u4ef6\u53c2\u6570\u5fc5\u987b\u4e3aString,Object\u7c7b\u578b,\u4e14\u53c2\u6570\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7255\u4e2a\u5b57\u7b26")):console.error("\u4e8b\u4ef6\u540d\u79f0\u5fc5\u987b\u4e3aString\u7c7b\u578b\u4e14\u4e0d\u80fd\u8d85\u8fc7255\u4e2a\u5b57\u7b26")},aldOnShareAppMessage:function(t){wx.onShareAppMessage(function(){I=!0;var a=t(),s="";s=void 0!==m.query.ald_share_src?void 0!==a.query?(m.query.ald_share_src.indexOf(d),a.query+"&ald_share_src="+m.query.ald_share_src+","+d):(m.query.ald_share_src.indexOf(d),"ald_share_src="+m.query.ald_share_src+","+d):void 0!==a.query?a.query+"&ald_share_src="+d:"ald_share_src="+d,"undefined"!=e(a.ald_desc)&&(s+="&ald_desc="+a.ald_desc),a.query=s;var o=r(l);return o.ct=a,o.ct.sho=1,o.tp="ald_share_chain",n(o,"event"),a})},aldShareAppMessage:function(t){I=!0;var a=t,s="";s=void 0!==m.query.ald_share_src?void 0!==a.query?(m.query.ald_share_src.indexOf(d),a.query+"&ald_share_src="+m.query.ald_share_src+","+d):(m.query.ald_share_src.indexOf(d),"ald_share_src="+m.query.ald_share_src+","+d):void 0!==a.query?a.query+"&ald_share_src="+d:"ald_share_src="+d;var o=r(l);"undefined"!=e(a.ald_desc)&&(s+="&ald_desc="+a.ald_desc),a.query=s,o.ct=a,o.tp="ald_share_chain",n(o,"event"),wx.shareAppMessage(a)},aldSendSession:function(e){if(""!==e&&e){var t=r(l);t.tp="session",t.ct="session",f=e,""===S?wx.getSetting({success:function(e){e.authSetting["scope.userInfo"]?wx.getUserInfo({success:function(e){t.ufo=e,n(t,"event")}}):n(t,"event")}}):(t.ufo=S,""!==S&&(t.gid=""),n(t,"event"))}else console.error("\u8bf7\u4f20\u5165\u4ece\u540e\u53f0\u83b7\u53d6\u7684session_key")},aldSendOpenid:function(e){if(""!==e&&e){h=e;var t=r(l);t.tp="openid",t.ct="openid",n(t,"event")}else console.error("openID\u4e0d\u80fd\u4e3a\u7a7a")}};wx.aldStage=new function(){function t(t){return!/^\d+(.\d+)*$/.test(t.stageId)||t.stageId.length>32?(console.warn("\u5173\u5361stageId\u5fc5\u987b\u7b26\u5408\u4f20\u53c2\u89c4\u5219,\u8bf7\u53c2\u8003\u6587\u6863\u3002"),!1):!("string"!==e(t.stageName)||t.stageName.length>32)||(console.warn("\u5173\u5361\u540d\u79f0\u4e3a\u5fc5\u4f20\u5b57\u6bb5,\u4e14\u957f\u5ea6\u5c0f\u4e8e32\u4e2a\u5b57\u7b26,\u8bf7\u53c2\u8003\u6587\u6863"),!1)}var a="",s="",o=0;this.onStart=function(n){if(t(n)){var r={};o=Date.now(),r.sid=n.stageId,r.snm=n.stageName,r.state="start",s=""+Date.now()+Math.floor(1e7*Math.random()),a=r,("string"===e(n.userId)&&n.userId)<32&&(this.uid=n.uid),this.request()}},this.onRunning=function(n){if(t(n)){var r={params:{}};if(("string"===e(n.userId)&&n.userId)<32&&(this.uid=n.uid),!e(n.event)&&-1!=M.join(",").indexOf(n.event+","))return void M.join(",");if(r.event=n.event,"object"===e(n.params)){if("string"!==e(n.params.itemName)||n.params.itemName.length>32)return void console.warn("\u9053\u5177/\u5546\u54c1\u540d\u79f0\u4e3a\u5fc5\u4f20\u5b57\u6bb5\uff0c\u4e14\u957f\u5ea6\u5c0f\u4e8e32\u4e2a\u5b57\u7b26\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003\u6587\u6863");r.params.itnm=n.params.itemName,"string"===e(n.params.itemId)&&n.params.itemId.length<32&&(r.params.itid=n.params.itemId),"number"===e(n.params.itemCount)&&n.params.itemCount.length<32?r.params.itco=n.params.itemCount:r.params.itco=1,-1!==n.event.indexOf("pay")&&("number"===e(n.params.itemMoney)&&n.params.itemMoney.length<32?r.params.money=n.params.itemMoney:r.params.money=0),"string"===e(n.params.desc)&&n.params.desc.length<64&&(r.params.desc=n.params.desc),r.state="running",r.sid=n.stageId,r.snm=n.stageName,a=r,this.request()}}},this.onEnd=function(n){if(t(n)){var r={state:"end"};if(("string"===e(n.userId)&&n.userId)<32&&(this.uid=n.uid),!e(n.event)&&-1!==k.join(",").indexOf(n.event+","))return void k.join(",");r.sid=n.stageId,r.snm=n.stageName,r.event=n.event,r.sdr=0!==o?Date.now()-o:"",r.params={},"object"===e(n.params)&&"string"===e(n.params.desc)&&n.params.desc.length<64&&(r.params.desc=n.params.desc),a=r,this.request()}},this.request=function(){var e=r(l);a.ss=s,e.ct=a,n(e,"screen")}};for(var j=0;j<b.length;j++)!function(e,t){Object.defineProperty(wx,e,{value:t,writable:!1,enumerable:!0,configurable:!0})}(b[j],O[b[j]]);try{var D=wx.getSystemInfoSync();l.br=D.brand||"",l.md=D.model,l.pr=D.pixelRatio,l.sw=D.screenWidth,l.sh=D.screenHeight,l.ww=D.windowWidth,l.wh=D.windowHeight,l.lang=D.language,l.wv=D.version,l.sv=D.system,l.wvv=D.platform,l.fs=D.fontSizeSetting,l.wsdk=D.SDKVersion,l.bh=D.benchmarkLevel||"",l.bt=D.battery||"",l.wf=D.wifiSignal||"",l.lng="",l.lat="",l.nt="",l.spd="",l.ufo=""}catch(N){}}();